import{r as u,j as e,S as Is,M as ke,L as Ce,O as He,P as Rs,C as Ye,T as Ee,a as Ve,X as B,D as Ge,R as Us,b as Ms,c as Be,d as qs,e as $s,U as _s,f as ue,g as K,A as Fs,h as Hs,i as Ys,B as Vs,k as We,l as Gs,m as Bs,n as Je,I as Qe,o as Ke,p as Ws,q as Js,s as Xe,t as Ze,u as Qs,v as R,w as we,E as es,x as ae,y as Ks,z as W,F as J,G as be,H as Re,J as Xs,K as Zs,N as et,Q as st,V as tt,W as rt,Y as at}from"./vendor-react-B99WvjmA.js";import{t as nt,n as ot,p as it,q as lt,r as ct,A as dt,v as ut}from"./vendor-other-BJEIYL5l.js";import{a as mt}from"./vendor-ui-DIarEfnZ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();typeof window<"u"&&(window.React=window.React||{},window.React.useLayoutEffect=window.React.useLayoutEffect||function(){return function(){}});const Ae={user:null,isLoading:!0,isAuthenticated:!1,error:null},ss=u.createContext({state:Ae,requestMagicLink:async()=>({success:!1,error:"Not implemented"}),signOut:async()=>({success:!1,error:"Not implemented"}),updateProfile:async()=>({success:!1,error:"Not implemented"})}),pt=()=>{try{const s=localStorage.getItem("mockUsers");if(s)return JSON.parse(s)}catch(s){console.error("Error loading saved mock users:",s)}return{}},xr=pt();const ht=()=>{try{const s=localStorage.getItem("mockAuthSession");if(s)return{user:JSON.parse(s)}}catch(s){console.error("Error loading saved session:",s)}return{user:null}},fr=ht();const ne=void 0,oe=!1,gt=async(s,t)=>{try{if(!oe)try{const r=await fetch(`${ne}/auth/signin/magic-link`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,callbackURL:t||"/main"})});if(!r.ok)throw new Error(`Failed to request magic link: ${r.statusText}`);return{success:!0}}catch(r){throw console.error("API error requesting magic link:",r),r}}catch(r){return console.error("Error requesting magic link:",r),{success:!1,error:r instanceof Error?r.message:"Failed to send magic link"}}},xt=async s=>{try{if(!oe)try{const t=await fetch(`${ne}/auth/verify?token=${encodeURIComponent(s)}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to verify token: ${t.statusText}`);return{success:!0,user:(await t.json()).user}}catch(t){throw console.error("API error verifying token:",t),t}}catch(t){return console.error("Error verifying magic link:",t),{success:!1,error:t instanceof Error?t.message:"Failed to verify magic link"}}},ft=async()=>{try{if(!oe)try{const s=await fetch(`${ne}/auth/user`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to get user: ${s.statusText}`);return{user:(await s.json()).user||null}}catch(s){throw console.error("API error getting current user:",s),s}}catch(s){return console.error("Error getting current user:",s),{user:null,error:s instanceof Error?s.message:"Failed to get current user"}}},yt=async()=>{try{if(!oe)try{const s=await fetch(`${ne}/auth/signout`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to sign out: ${s.statusText}`);return{success:!0}}catch(s){throw console.error("API error signing out:",s),s}}catch(s){return console.error("Error signing out:",s),{success:!1,error:s instanceof Error?s.message:"Failed to sign out"}}},bt=async(s,t)=>{try{if(!oe)try{const r=await fetch(`${ne}/auth/users/${s}/profile`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Failed to update profile: ${r.statusText}`);return{success:!0,user:(await r.json()).user}}catch(r){throw console.error("API error updating profile:",r),r}}catch(r){return console.error("Error updating profile:",r),{success:!1,error:r instanceof Error?r.message:"Failed to update profile"}}},jt=(s=Ae,t)=>{switch(t.type){case"AUTH_LOADING":return{...s,isLoading:!0,error:null};case"AUTH_SUCCESS":return{...s,isLoading:!1,isAuthenticated:!0,user:t.payload,error:null};case"AUTH_FAILURE":return{...s,isLoading:!1,isAuthenticated:!1,user:null,error:t.payload};case"AUTH_LOGOUT":return{...s,isLoading:!1,isAuthenticated:!1,user:null,error:null};default:return s}},vt=({children:s})=>{const[t,r]=u.useReducer(jt,Ae);u.useEffect(()=>{const n=async()=>{r({type:"AUTH_LOADING"});try{const{user:d,error:h}=await ft();r(d?{type:"AUTH_SUCCESS",payload:d}:{type:"AUTH_FAILURE",payload:h||"No user found"})}catch(d){r({type:"AUTH_FAILURE",payload:d instanceof Error?d.message:"Authentication failed"})}};n();const c=d=>{d.key==="auth"&&d.newValue&&n()};return window.addEventListener("storage",c),()=>window.removeEventListener("storage",c)},[]);const a=async(n,c)=>{r({type:"AUTH_LOADING"});const d=await gt(n,c);return d.success||r({type:"AUTH_FAILURE",payload:d.error||"Failed to send magic link"}),d},o=async()=>{r({type:"AUTH_LOADING"});const n=await yt();return n.success?r({type:"AUTH_LOGOUT"}):r({type:"AUTH_FAILURE",payload:n.error||"Failed to sign out"}),n},i=async n=>{var d;if(!((d=t.user)!=null&&d.id))return{success:!1,error:"No authenticated user"};r({type:"AUTH_LOADING"});const c=await bt(t.user.id,n);return c.success&&c.user?(r({type:"AUTH_SUCCESS",payload:c.user}),{success:!0}):(r({type:"AUTH_FAILURE",payload:c.error||"Failed to update profile"}),{success:!1,error:c.error})};return e.jsx(ss.Provider,{value:{state:t,requestMagicLink:a,signOut:o,updateProfile:i},children:s})},ts=u.createContext(void 0),wt=(s,t)=>{switch(t.type){case"SET_USERNAME":return{...s,username:t.payload};case"SET_MANAGER_NAME":return{...s,managerName:t.payload};case"SET_MANAGER_EMAIL":return{...s,managerEmail:t.payload};case"SET_ENTRIES":return{...s,entries:t.payload};case"ADD_ENTRY":return{...s,entries:[...s.entries,t.payload]};case"UPDATE_ENTRY":return{...s,entries:s.entries.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_ENTRY":return{...s,entries:s.entries.filter(r=>r.id!==t.payload)};default:return s}},Nt=({children:s})=>{const[t,r]=u.useReducer(wt,{entries:[],username:"",managerName:"",managerEmail:""});return e.jsx(ts.Provider,{value:{data:t,setData:r},children:s})},rs=u.createContext(void 0),St=[{id:"q1",category:"wellbeing",mainQuestion:"Share any factors, either at work or outside, that might affect your wellbeing.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"what?",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this statement?",preset:!1,presetAnswer:null}}},{id:"q2",category:"wellbeing",mainQuestion:"Express how you feel on a good day at work.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!1},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Express",allowedVerbs:["Express","Share"]},object:{question:"Describe your feelings and actions on a good day.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this statement?",preset:!1,presetAnswer:null}}},{id:"q3",category:"wellbeing",mainQuestion:"Share the signs that indicate you're having a difficult day at work.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"List any changes in behavior, communication, or appearance that signal a difficult day.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this statement?",preset:!1,presetAnswer:null}}},{id:"q4",category:"wellbeing",mainQuestion:"Specify how we can support you when things are not going well.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Support",allowedVerbs:["Support","Help","Assist"]},object:{question:"Detail the actions and approach you prefer for support.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share your support preferences?",preset:!1,presetAnswer:null}}},{id:"q5",category:"wellbeing",mainQuestion:"Share the symptoms that indicate you're not well enough to be at work.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"List the symptoms affecting your work readiness.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this assessment?",preset:!1,presetAnswer:null}}},{id:"q6",category:"parental",mainQuestion:"Share your parental or caring responsibilities.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"Describe any parental or caring responsibilities you have.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this information?",preset:!1,presetAnswer:null}}},{id:"q7",category:"parental",mainQuestion:"Specify the support or arrangements you need to fulfill your role as a parent or carer.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Support",allowedVerbs:["Support","Help"]},object:{question:"Detail the support or arrangements you require.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share these details?",preset:!1,presetAnswer:null}}},{id:"q8",category:"religious",mainQuestion:"Specify the support or arrangements you need to practice your religion or beliefs at work.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Support",allowedVerbs:["Support","Help"]},object:{question:"Describe any necessary accommodations for your religious practices (e.g., prayer space, holidays).",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this information?",preset:!1,presetAnswer:null}}},{id:"q9",category:"religious",mainQuestion:"Share any additional information about your religion or beliefs that would be helpful for us.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"Provide any extra details, such as dietary requirements or other relevant religious information.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share these details?",preset:!1,presetAnswer:null}}},{id:"q10",category:"disability",mainQuestion:"Share the impact of your disability or long-term condition on your work.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"Detail the impact and any related conditions affecting your work.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this information?",preset:!1,presetAnswer:null}}},{id:"q11",category:"disability",mainQuestion:"Share the barriers or challenges you face at work due to your disability or long-term condition.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"List the challenges and how they impact your job performance.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share these challenges?",preset:!1,presetAnswer:null}}},{id:"q12",category:"colleague_Sharing",mainQuestion:"Share the information about your work needs that would be helpful for your colleagues.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Share",allowedVerbs:["Share"]},object:{question:"Detail what your colleagues should know and how you prefer this information to be shared.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this information with your colleagues?",preset:!1,presetAnswer:null}}},{id:"q13",category:"employer_Support",mainQuestion:"Specify the support or understanding you need from us as your employer.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Support",allowedVerbs:["Support","Help","Assist"]},object:{question:"Describe how we can better support and communicate with you.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share your support preferences?",preset:!1,presetAnswer:null}}},{id:"q14",category:"personal_Introduction",mainQuestion:"Introduce yourself to your team.",steps:{subject:{question:"Who is this statement about?",preset:!0,presetAnswer:"username",allowDescriptors:!0},verb:{question:"Select the action verb for your statement.",preset:!0,presetAnswer:"Introduce",allowedVerbs:["Introduce","Share"]},object:{question:"Provide a brief personal and professional introduction including key details.",preset:!1,presetAnswer:null},privacy:{question:"Do you want to share this introduction with your team?",preset:!1,presetAnswer:null}}}],kt={setQuestions:St},Ct=({children:s})=>{const[t,r]=u.useState([]);u.useEffect(()=>{r(kt.setQuestions)},[]);const a={questions:t,setQuestions:r};return e.jsx(rs.Provider,{value:a,children:s})},De=()=>{const s=u.useContext(ss);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s};function q(){const s=u.useContext(ts);if(!s)throw new Error("useStatements must be used within a StatementsProvider");return s}const Ne=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s);function z(...s){return nt(ot(s))}function Se(s){return s.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const Y=u.forwardRef(({className:s,type:t,...r},a)=>e.jsx("input",{type:t,className:z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...r}));Y.displayName="Input";const Et=mt("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand-pink text-white shadow-sm hover:bg-brand-pink/90 transition-colors",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-pink-200 bg-white text-gray-700  hover:border-pink-300 transition-colors",outlineVerbs:"border border-pink-200 bg-white text-gray-700 hover:bg-brand-pink hover:border-pink-300 transition-colors",secondary:"bg-pink-100 text-brand-pink border border-pink-200  transition-colors",ghost:"hover:bg-pink-50 hover:text-brand-pink transition-colors",link:"text-brand-pink underline-offset-4 hover:underline",pink:"rounded-full flex items-center gap-1.5 px-6 py-3 shadow-md bg-brand-pink text-white text-lg hover:bg-brand-darkPurple transition-colors",success:"bg-emerald-500 text-white shadow-sm hover:bg-emerald-600 transition-colors",warning:"bg-amber-500 text-white shadow-sm hover:bg-amber-600 transition-colors",info:"bg-blue-500 text-white shadow-sm hover:bg-blue-600 transition-colors"},size:{default:"h-10 px-4 py-2",sm:"h-8 text-xs px-3 py-1",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",compact:"h-8 px-3 py-1"},selected:{true:"bg-[var(--tile-color)]",false:""}},defaultVariants:{variant:"default",size:"default",selected:!1}}),j=u.forwardRef(({className:s,variant:t,size:r,selected:a,asChild:o=!1,...i},n)=>{const c=o?Is:"button";return e.jsx(c,{className:z(Et({variant:t,size:r,selected:a,className:s})),ref:n,...i})});j.displayName="Button";const At=({callbackURL:s="/main",onSuccess:t})=>{const{requestMagicLink:r,state:a}=De(),[o,i]=u.useState(""),[n,c]=u.useState(!1),[d,h]=u.useState(""),m=async g=>{if(g.preventDefault(),!o.trim()){h("Email is required");return}if(!Ne(o)){h("Please enter a valid email address");return}h("");const w=await r(o,s);w.success?(c(!0),t&&t()):h(w.error||"Failed to send login link")};return n?e.jsx("div",{className:"p-6 bg-white rounded-lg shadow-md border border-pink-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ke,{className:"w-12 h-12 mx-auto text-brand-pink mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Check your inbox"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["We've sent a magic link to ",e.jsx("span",{className:"font-medium",children:o})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click the link in the email to sign in to your account. The link will expire in 5 minutes."})]})}):e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx(Y,{id:"email",type:"email",value:o,onChange:g=>i(g.target.value),placeholder:"Enter your email",className:`w-full ${d?"border-red-500":""}`,autoComplete:"email",disabled:a.isLoading}),d&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:d})]}),e.jsx(j,{type:"submit",className:"w-full",variant:"pink",disabled:a.isLoading,children:a.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):"Send Magic Link"})]})},as=async()=>{const t=new URLSearchParams(window.location.search).get("token");if(!t)return{success:!1,error:"No authentication token found"};console.log("Magic link token found in URL, verifying:",t);const r=await xt(t);if(console.log("Token verification result:",r),r.success){console.log("Token verified successfully, user:",r.user);const a=window.location.pathname;window.history.replaceState({},document.title,a),window.localStorage.setItem("auth","updated"),window.localStorage.removeItem("auth"),window.dispatchEvent(new CustomEvent("magicLinkVerified",{detail:{user:r.user}}))}return r},Dt=({onSubmit:s})=>{var w;const{state:t}=De(),{setData:r}=q(),[a,o]=u.useState(""),[i,n]=u.useState(""),[c,d]=u.useState("authenticate"),[h,m]=u.useState(!1);u.useEffect(()=>{const S=async()=>{m(!0);const C=await as();m(!1),C.success&&C.user&&d("profile")};S();const x=()=>{S()},l=C=>{console.log("Magic link verified event received:",C.detail),d("profile")},E=()=>{console.log("Verify magic link event received"),S()};return window.addEventListener("popstate",x),window.addEventListener("magicLinkVerified",l),window.addEventListener("verifyMagicLink",E),()=>{window.removeEventListener("popstate",x),window.removeEventListener("magicLinkVerified",l),window.removeEventListener("verifyMagicLink",E)}},[]),u.useEffect(()=>{t.isAuthenticated&&t.user&&d("profile")},[t.isAuthenticated,t.user]);const g=S=>{var x,l;S.preventDefault(),a.trim()&&(r({type:"SET_USERNAME",payload:a.trim()}),i.trim()&&r({type:"SET_MANAGER_NAME",payload:i.trim()}),(x=t.user)!=null&&x.email&&r({type:"SET_MANAGER_EMAIL",payload:t.user.email}),s&&s(a.trim(),i.trim(),((l=t.user)==null?void 0:l.email)||""))};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ce,{className:"h-12 w-12 animate-spin text-brand-pink mb-4"}),e.jsx("h2",{className:"text-xl font-medium",children:"Verifying your login..."})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsx("div",{className:"bg-white shadow-lg rounded-lg p-8 max-w-md w-full",children:c==="authenticate"?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Welcome to Beacons"}),e.jsx("p",{className:"mb-6 text-center text-gray-700",children:"Sign in with your email to access the application."}),e.jsx(At,{callbackURL:"/main"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Complete Your Profile"}),e.jsx("p",{className:"mb-6 text-center text-gray-700",children:"Please enter your name and, optionally, your line manager's name to continue."}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name"}),e.jsx(Y,{id:"name",placeholder:"Enter your name",value:a,onChange:S=>o(S.target.value),className:"w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"managerName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Line Manager's Name (optional)"}),e.jsx(Y,{id:"managerName",placeholder:"Enter your manager's name",value:i,onChange:S=>n(S.target.value),className:"w-full"})]}),((w=t.user)==null?void 0:w.email)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded text-gray-800",children:t.user.email}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You signed in with this email address"})]}),e.jsx(j,{type:"submit",variant:"pink",className:"mx-auto shadow-sm w-full mt-6",disabled:!a.trim(),children:"Continue"})]})]})})})},X=Us,Ue=Ms,Tt=Rs,Me=Ve,ns=u.forwardRef(({className:s,...t},r)=>e.jsx(He,{ref:r,className:z("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));ns.displayName=He.displayName;const Z=u.forwardRef(({className:s,children:t,headerTitle:r,...a},o)=>e.jsxs(Tt,{children:[e.jsx(ns,{}),e.jsxs(Ye,{ref:o,className:z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border-0 bg-background p-0 shadow-lg duration-200",r&&"sm:rounded-lg",s),...a,children:[r&&e.jsxs("div",{className:"bg-brand-pink p-2 flex items-center justify-between sm:rounded-t-lg",children:[e.jsx(Ee,{className:"text-xl font-semibold text-white",children:r}),e.jsx(Ve,{asChild:!0,children:e.jsx("button",{className:"text-white","aria-label":"Close",children:e.jsx(B,{size:24})})})]}),e.jsx("div",{className:r?"p-4 bg-gray-50 sm:rounded-b-lg":"p-4",children:t})]})]}));Z.displayName=Ye.displayName;const os=({className:s,...t})=>e.jsx("div",{className:z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});os.displayName="DialogFooter";const me=u.forwardRef(({className:s,...t},r)=>e.jsx(Ee,{ref:r,className:z("text-lg font-semibold leading-none tracking-tight",s),...t}));me.displayName=Ee.displayName;const ee=u.forwardRef(({className:s,...t},r)=>e.jsx(Ge,{ref:r,className:z("text-sm text-muted-foreground",s),...t}));ee.displayName=Ge.displayName;function Te(){const s=u.useContext(rs);if(!s)throw new Error("useQuestions must be used within a QuestionsProvider");return s}function pe(){const{questions:s}=Te(),{data:t}=q();return{answered:s.filter(a=>t.entries.some(o=>o.presetId===a.id)).length,total:s.length}}function Pt(){const{questions:s}=Te(),{data:t}=q(),r=c=>{const d=c.toLowerCase();return["uncategorized","uncategorised"].includes(d)?"uncategorized":d},a=s.reduce((c,d)=>{const h=r(d.category||"uncategorized");return c[h]||(c[h]=[]),c[h].push(d),c},{}),o=Object.entries(a).reduce((c,[d,h])=>{const m=h.filter(g=>t.entries.some(w=>w.presetId===g.id)).length;return c[d]={answered:m,total:h.length},c},{}),i=Object.values(o).reduce((c,{answered:d})=>c+d,0),n=Object.values(o).reduce((c,{total:d})=>c+d,0);return{categoryCounts:o,totalAnswered:i,totalQuestions:n}}const ce=({size:s=24,strokeWidth:t=4})=>{const{answered:r,total:a}=pe(),o=a>0?Math.round(r/a*100):0,i=(s-t)/2,n=2*Math.PI*i,c=n*(1-o/100);return e.jsxs("svg",{width:s,height:s,viewBox:`0 0 ${s} ${s}`,children:[e.jsx("circle",{className:"text-gray-200",stroke:"currentColor",strokeWidth:t,fill:"transparent",r:i,cx:s/2,cy:s/2}),e.jsx("circle",{className:"text-green-500",stroke:"currentColor",strokeWidth:t,fill:"transparent",r:i,cx:s/2,cy:s/2,strokeDasharray:n,strokeDashoffset:c,transform:`rotate(-90 ${s/2} ${s/2})`,style:{transition:"stroke-dashoffset 0.35s ease-out"}})]})},F=qs,H=$s,M=u.forwardRef(({className:s,sideOffset:t=4,...r},a)=>e.jsx(Be,{ref:a,sideOffset:t,className:z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));M.displayName=Be.displayName;const zt=({className:s})=>{const{answered:t,total:r}=pe();return e.jsxs("div",{className:z("text-sm text-gray-700",s),children:[t," / ",r," questions answered"]})},Ot=[{range:[0,10],messages:["Taking the first step is the beginning of a meaningful journey.","Your openness starts the path to self-discovery.","Every journey begins with a single step.","The beginning of reflection shows courage."]},{range:[10,20],messages:["You're starting to build a foundation for self-awareness.","Early insights create the foundation for growth.","Your initial reflections show promising self-awareness.","You're beginning to reveal parts of your authentic self."]},{range:[20,30],messages:["You're making steady progress on your reflective journey.","Your growing insights are creating a clearer picture.","Continuing to explore helps you understand yourself better.","Each statement adds depth to your self-awareness."]},{range:[30,40],messages:["Your commitment to reflection is becoming evident.","You're developing a meaningful narrative about yourself.","Your persistence is revealing important patterns.","Your journey is gathering momentum."]},{range:[40,50],messages:["You're approaching the halfway point with meaningful insights.","Your reflections are building a comprehensive self-portrait.","The depth of your sharing shows genuine commitment.","Your dedication to self-understanding is admirable."]},{range:[50,60],messages:["You've crossed the halfway mark - your commitment shows.","Your consistent reflection reveals your dedication to growth.","Your journey is well underway, showing true dedication.","The breadth of your insights demonstrates remarkable self-awareness."]},{range:[60,70],messages:["Your substantial progress reveals a deeply thoughtful person.","The richness of your responses shows impressive depth.","You're building a comprehensive understanding of yourself.","Your dedication to this process is truly inspiring."]},{range:[70,80],messages:["Your journey shows remarkable commitment to self-discovery.","The tapestry of your reflections is rich and nuanced.","You've shared insights that reflect deep self-understanding.","Your dedication to authenticity is powerful."]},{range:[80,90],messages:["You're approaching completion with exceptional insights.","Your comprehensive sharing reveals uncommon self-awareness.","The depth and breadth of your reflections are truly remarkable.","Your commitment to this process shows incredible dedication."]},{range:[90,100],messages:["Your complete picture shows extraordinary self-awareness.","You've created a comprehensive map of your authentic self.","Your dedication to this journey has been remarkable.","The fullness of your reflections reveals profound understanding."]},{range:[100,100],messages:["Congratulations on completing your self-reflection journey!","You've achieved complete self-reflection - a remarkable accomplishment.","Your full commitment reveals a person of exceptional introspection.","The complete tapestry of your insights shows extraordinary dedication."]}],Lt={feedbackBrackets:Ot};function It(s){return u.useMemo(()=>{const t=Lt.feedbackBrackets.find(a=>s>=a.range[0]&&s<=a.range[1]);if(!t)return"Keep reflecting on your journey.";const r=Math.floor(Math.random()*t.messages.length);return t.messages[r]},[s])}const qe=({size:s=100,strokeWidth:t=6,className:r=""})=>{const{answered:a,total:o}=pe(),i=o>0?Math.round(a/o*100):0,n=(s-t)/2,c=2*Math.PI*n,d=c*(1-i/100);return e.jsxs("div",{className:`relative w-fit ${r}`,children:[e.jsxs("svg",{width:s,height:s,viewBox:`0 0 ${s} ${s}`,children:[e.jsx("circle",{className:"text-gray-200",stroke:"currentColor",strokeWidth:t,fill:"transparent",r:n,cx:s/2,cy:s/2}),e.jsx("circle",{className:"text-brand-pink",stroke:"currentColor",strokeWidth:t,fill:"transparent",r:n,cx:s/2,cy:s/2,strokeDasharray:c,strokeDashoffset:d,transform:`rotate(-90 ${s/2} ${s/2})`,style:{transition:"stroke-dashoffset 0.35s ease-out"}})]}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-lg font-semibold",children:[i,"%"]})]})},Rt=()=>{const{answered:s,total:t}=pe(),r=t>0?Math.round(s/t*100):0,a=It(r);return e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-4 lg:gap-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx(qe,{size:90,strokeWidth:5,className:"sm:hidden"}),e.jsx(qe,{size:120,className:"hidden sm:block"})]}),e.jsx("div",{className:"flex-1 text-center lg:text-left",children:e.jsxs("p",{className:"text-gray-700 text-sm sm:text-base italic font-medium",children:['"',a,'"']})})]})},$e=({onOpenChange:s})=>{const{data:t,setData:r}=q(),{signOut:a}=De(),[o,i]=u.useState(!1),[n,c]=u.useState(!1),[d,h]=u.useState(t.managerEmail||""),[m,g]=u.useState(t.managerName||""),[w,S]=u.useState(t.username||""),[x,l]=u.useState(""),E=async()=>{await a(),r({type:"SET_USERNAME",payload:""}),r({type:"SET_MANAGER_NAME",payload:""}),r({type:"SET_MANAGER_EMAIL",payload:""}),s(!1)};u.useEffect(()=>{o&&(h(t.managerEmail||""),g(t.managerName||"")),n&&S(t.username||"")},[o,n,t.managerEmail,t.managerName,t.username]);const C=()=>{if(d.trim()&&!Ne(d.trim())){l("Please enter a valid email address.");return}r({type:"SET_MANAGER_EMAIL",payload:d}),r({type:"SET_MANAGER_NAME",payload:m}),i(!1),l("")},P=()=>{r({type:"SET_USERNAME",payload:w}),c(!1)};return e.jsxs(Z,{className:"max-w-3xl p-0 overflow-hidden",onOpenAutoFocus:A=>A.preventDefault(),children:[e.jsxs("div",{className:"bg-brand-pink p-2 flex items-center justify-between sm:rounded-t-lg",children:[e.jsx(me,{className:"text-xl font-semibold text-white",children:"User's Data"}),e.jsx(Me,{className:"text-white focus:outline-none focus:ring-2 focus:ring-white rounded-sm",children:e.jsx(B,{size:24})})]}),e.jsx(ee,{className:"sr-only",children:"Dashboard with user information and settings."}),e.jsx("div",{className:"relative overflow-auto",style:{background:"linear-gradient(135deg, #f5f7fa 0%, #f8f9fb 100%)"},children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-4 lg:w-1/2",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-pink-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_s,{size:16,className:"text-brand-pink mr-1"}),e.jsx("div",{className:"text-xs font-semibold text-gray-700",children:"Your name"})]}),!n&&e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("button",{className:"flex items-center justify-center rounded-full bg-pink-50 p-1 text-brand-pink hover:bg-pink-100 transition-colors","aria-label":"Edit your name",onClick:()=>c(!0),type:"button",children:e.jsx(ue,{size:14})})}),e.jsx(M,{children:"Edit your name"})]})]}),n?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:w,onChange:A=>S(A.target.value),placeholder:"Enter your name","aria-label":"Your Name",className:"w-full border-pink-200 focus:border-brand-pink text-sm"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(j,{onClick:P,variant:"pink",size:"sm","aria-label":"Save Name",className:"px-2 py-0.5 h-auto text-xs",type:"button",children:[e.jsx(K,{size:12,className:"mr-1"}),"Save"]}),e.jsxs(j,{onClick:()=>{c(!1),S(t.username||"")},variant:"outline",size:"sm","aria-label":"Cancel Editing",className:"px-2 py-0.5 h-auto text-xs",type:"button",children:[e.jsx(B,{size:12,className:"mr-1"}),"Cancel"]})]})]}):e.jsx("div",{className:"bg-pink-50 px-2 py-1 rounded-md text-sm font-medium text-gray-800",children:t.username||"Not set"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-pink-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ke,{size:16,className:"text-brand-pink mr-1"}),e.jsx("div",{className:"text-xs font-semibold text-gray-700",children:"Line manager's details"})]}),!o&&e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("button",{className:"flex items-center justify-center rounded-full bg-pink-50 p-1 text-brand-pink hover:bg-pink-100 transition-colors","aria-label":"Edit your line manager's details",onClick:()=>i(!0),type:"button",children:e.jsx(ue,{size:14})})}),e.jsx(M,{children:"Edit line manager's details"})]})]}),o?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:e.jsx(Y,{value:m,onChange:A=>g(A.target.value),placeholder:"Manager's name","aria-label":"Manager Name",className:"w-full border-pink-200 focus:border-brand-pink text-sm mb-1"})}),e.jsxs("div",{children:[e.jsx(Y,{value:d,onChange:A=>h(A.target.value),placeholder:"Manager's email","aria-label":"Manager Email",className:"w-full border-pink-200 focus:border-brand-pink text-sm"}),x&&e.jsx("div",{className:"text-red-500 text-xs mt-0.5",children:x})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(j,{onClick:C,variant:"pink",size:"sm","aria-label":"Save Contact",className:"px-2 py-0.5 h-auto text-xs",disabled:d.trim()!==""&&!Ne(d.trim()),type:"button",children:[e.jsx(K,{size:12,className:"mr-1"}),"Save"]}),e.jsxs(j,{onClick:()=>{i(!1),h(t.managerEmail||""),g(t.managerName||""),l("")},variant:"outline",size:"sm","aria-label":"Cancel Editing",className:"px-2 py-0.5 h-auto text-xs",type:"button",children:[e.jsx(B,{size:12,className:"mr-1"}),"Cancel"]})]})]}):e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"bg-pink-50 px-2 py-1 rounded-md mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Name:"})," ",e.jsx("span",{className:"font-medium text-gray-800",children:t.managerName||"Not set"})]}),e.jsxs("div",{className:"bg-pink-50 px-2 py-1 rounded-md",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Email:"})," ",e.jsx("span",{className:"font-medium text-gray-800",children:t.managerEmail||"Not set"})]})]})]})]}),e.jsx("div",{className:"lg:w-1/2",children:e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-pink-100 h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fs,{size:16,className:"text-brand-pink mr-1"}),e.jsx("div",{className:"text-xs font-semibold text-gray-700",children:"Your progress"})]}),e.jsx(zt,{})]}),e.jsx("div",{className:"bg-pink-50 p-2 sm:p-4 rounded-lg",children:e.jsx(Rt,{})})]})})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(Me,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"px-4",type:"button",children:[e.jsx(B,{size:16,className:"mr-1.5"}),"Close"]})}),e.jsxs("button",{onClick:E,className:"flex items-center justify-center py-2 px-4 rounded-md border border-pink-100 text-red-600 hover:bg-red-50 transition-colors",type:"button",children:[e.jsx(Hs,{size:16,className:"mr-1.5"}),e.jsx("span",{className:"font-medium",children:"Sign Out"})]})]})]})})]})},Ut=()=>{const{data:s}=q(),[t,r]=u.useState(!1);return e.jsx("header",{className:"bg-brand-pink text-white p-4 shadow-md sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[e.jsxs("div",{className:"flex w-full min-[580px]:w-auto items-center justify-between min-[580px]:justify-start",children:[e.jsx("img",{src:"/lift_logo.png",alt:"Logo",className:"h-8 sm:h-10 mr-2 shrink-0"}),e.jsx("div",{className:"min-[580px]:hidden",children:s.username?e.jsxs(X,{open:t,onOpenChange:r,children:[e.jsx(Ue,{asChild:!0,children:e.jsxs("button",{className:"flex items-center shrink-0 border-2 border-white rounded-full px-2 py-1 sm:px-4 sm:py-2 cursor-pointer hover:bg-pink-600 transition-colors",children:[e.jsx("span",{className:"hidden sm:inline mr-2",children:"Logged as: "}),e.jsx("span",{className:"mr-2 text-xs sm:text-base truncate max-w-[100px] sm:max-w-[150px]",children:s.username}),e.jsx(ce,{size:18})]})}),e.jsx($e,{onOpenChange:r})]}):e.jsxs("div",{className:"flex shrink-0 items-center border-2 border-white rounded-full px-2 py-1 sm:px-4 sm:py-2 cursor-default",children:[e.jsx("span",{className:"hidden sm:inline mr-2",children:"Not logged in"}),e.jsx("span",{className:"sm:hidden mr-2 text-xs",children:"Guest"}),e.jsx(ce,{size:18})]})})]}),e.jsx("h1",{className:"text-xl sm:text-2xl font-bold w-full min-[580px]:w-auto min-[580px]:flex-1 text-left min-[580px]:text-center mt-2 min-[580px]:mt-0",children:"Beacons"}),e.jsx("div",{className:"hidden min-[580px]:block",children:s.username?e.jsxs(X,{open:t,onOpenChange:r,children:[e.jsx(Ue,{asChild:!0,children:e.jsxs("button",{className:"flex items-center shrink-0 border-2 border-white rounded-full px-2 py-1 sm:px-4 sm:py-2 cursor-pointer hover:bg-pink-600 transition-colors",children:[e.jsx("span",{className:"hidden sm:inline mr-2",children:"Logged as: "}),e.jsx("span",{className:"mr-2 text-xs sm:text-base truncate max-w-[100px] sm:max-w-[150px]",children:s.username}),e.jsx(ce,{size:18})]})}),e.jsx($e,{onOpenChange:r})]}):e.jsxs("div",{className:"flex shrink-0 items-center border-2 border-white rounded-full px-2 py-1 sm:px-4 sm:py-2 cursor-default",children:[e.jsx("span",{className:"hidden sm:inline mr-2",children:"Not logged in"}),e.jsx("span",{className:"sm:hidden mr-2 text-xs",children:"Guest"}),e.jsx(ce,{size:18})]})})]})})})};function is({isOpen:s,onClose:t,onConfirm:r,title:a,description:o,singleButton:i=!1}){return e.jsx(X,{open:s,onOpenChange:t,children:e.jsxs(Z,{headerTitle:a,className:"sm:max-w-md p-0",children:[e.jsx(ee,{className:"sr-only",children:o}),e.jsx("div",{className:"bg-gray-50 p-4",children:e.jsx("p",{className:"text-sm text-gray-800",children:o})}),e.jsx(os,{className:"p-4 bg-gray-50 sm:rounded-b-lg",children:i?e.jsx(j,{variant:"default",onClick:r,className:"inline-flex items-center",children:e.jsx("span",{children:"OK"})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"outline",onClick:t,className:"inline-flex items-center",children:e.jsx("span",{children:"Cancel"})}),e.jsx(j,{variant:"destructive",onClick:r,className:"inline-flex items-center",children:e.jsx("span",{children:"Delete"})})]})})]})})}const _e=({presetQuestion:s,onSelect:t,onToggleSnooze:r=()=>{}})=>{const a=o=>{o.stopPropagation(),r(s.id)};return e.jsx("div",{className:"relative",children:e.jsx("div",{onClick:s.isSnoozed?()=>{}:()=>t(s),className:z(s.isSnoozed?"cursor-default":"cursor-pointer",s.isSnoozed&&"opacity-60"),children:e.jsxs("div",{className:z("bg-white rounded-md p-3 shadow-sm flex items-center",!s.isSnoozed&&"hover:bg-gray-100","transition-colors border-2 border-dotted",s.isSnoozed?"border-blue-300":"border-brand-pink"),children:[!s.isSnoozed&&e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:"inline-flex items-center justify-center mr-2 text-brand-pink bg-pink-50 p-1 rounded-full",children:e.jsx(Ys,{size:16})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:"Your employer would like to ask you this question"})]}),e.jsx("span",{className:"flex-1 truncate text-lg",children:s.mainQuestion}),e.jsx("div",{className:"relative",children:e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("button",{onClick:a,className:z("mr-2 p-1.5 rounded-full transition-colors flex items-center justify-center","border border-gray-200 shadow-sm",s.isSnoozed?"hover:bg-blue-100 bg-blue-50":"hover:bg-gray-100"),"aria-label":s.isSnoozed?"Unsnooze question":"Snooze question",children:s.isSnoozed?e.jsx(Vs,{size:16,className:"text-blue-600"}):e.jsx(We,{size:16,className:"text-gray-600"})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:s.isSnoozed?"Unsnooze question":"Snooze question"})]})}),!s.isSnoozed&&e.jsx("span",{className:"inline-flex items-center justify-center p-1 rounded-full bg-gray-100 text-gray-500",children:e.jsx(Gs,{size:16})})]})})})},Mt=[{id:"v1",name:"Express",popularity:85,categories:["Communication"],color:"#ff5733"},{id:"v2",name:"Introduce",popularity:80,categories:["Communication"],color:"#33ff57"},{id:"v3",name:"Share",popularity:83,categories:["Engagement","Teamwork"],color:"#2ecc71"},{id:"v4",name:"Support",popularity:99,categories:["Support & Help","Guide & Encourage"],color:"#3498db"},{id:"v5",name:"Help",popularity:98,categories:["Support & Help"],color:"#2980b9"},{id:"v6",name:"Assist",popularity:87,categories:["Support & Help"],color:"#2c3e50"},{id:"v7",name:"Guide",popularity:85,categories:["Guide & Encourage"],color:"#34495e"},{id:"v8",name:"Encourage",popularity:84,categories:["Guide & Encourage"],color:"#16a085"},{id:"v9",name:"Facilitate",popularity:77,categories:["Guide & Encourage"],color:"#1abc9c"},{id:"v10",name:"Mentor",popularity:82,categories:["Guide & Encourage","Leadership"],color:"#27ae60",presentTenseForm:"mentor"},{id:"v11",name:"Advise",popularity:80,categories:["Guide & Encourage"],color:"#2ecc71"},{id:"v12",name:"Grow",popularity:92,categories:["Personal Growth"],color:"#8e44ad"},{id:"v13",name:"Improve",popularity:94,categories:["Personal Growth","Achievement"],color:"#9b59b6"},{id:"v14",name:"Develop",popularity:91,categories:["Personal Growth","Implementation"],color:"#7d3c98"},{id:"v15",name:"Progress",popularity:88,categories:["Personal Growth","Adaptation & Learning"],color:"#2980b9"},{id:"v16",name:"Adapt",popularity:90,categories:["Adaptation & Learning"],color:"#3498db"},{id:"v17",name:"Learn",popularity:89,categories:["Adaptation & Learning"],color:"#2c3e50"},{id:"v18",name:"Evolve",popularity:86,categories:["Adaptation & Learning","Personal Growth"],color:"#34495e"},{id:"v19",name:"Advance",popularity:87,categories:["Personal Growth","Achievement"],color:"#16a085"},{id:"v20",name:"Create",popularity:91,categories:["Creative Process"],color:"#1abc9c"},{id:"v21",name:"Innovate",popularity:82,categories:["Creative Process"],color:"#27ae60"},{id:"v22",name:"Design",popularity:88,categories:["Creative Process","Implementation"],color:"#2ecc71"},{id:"v23",name:"Build",popularity:86,categories:["Implementation"],color:"#8e44ad"},{id:"v24",name:"Transform",popularity:85,categories:["Implementation","Creative Process"],color:"#9b59b6"},{id:"v25",name:"Pioneer",popularity:83,categories:["Creative Process"],color:"#7d3c98",presentTenseForm:"pioneer"},{id:"v26",name:"Invent",popularity:81,categories:["Creative Process"],color:"#2980b9"},{id:"v27",name:"Craft",popularity:79,categories:["Implementation"],color:"#3498db"},{id:"v28",name:"Collaborate",popularity:88,categories:["Teamwork"],color:"#2c3e50"},{id:"v29",name:"Connect",popularity:86,categories:["Engagement"],color:"#34495e"},{id:"v30",name:"Engage",popularity:89,categories:["Engagement"],color:"#16a085"},{id:"v31",name:"Partner",popularity:85,categories:["Teamwork"],color:"#1abc9c",presentTenseForm:"partner"},{id:"v32",name:"Unite",popularity:84,categories:["Teamwork"],color:"#27ae60"},{id:"v33",name:"Network",popularity:82,categories:["Engagement"],color:"#8e44ad"},{id:"v34",name:"Cooperate",popularity:81,categories:["Teamwork"],color:"#9b59b6"},{id:"v35",name:"Lead",popularity:96,categories:["Leadership"],color:"#7d3c98"},{id:"v36",name:"Achieve",popularity:95,categories:["Achievement"],color:"#2980b9"},{id:"v37",name:"Excel",popularity:93,categories:["Achievement"],color:"#3498db"},{id:"v38",name:"Succeed",popularity:92,categories:["Achievement"],color:"#2c3e50"},{id:"v39",name:"Motivate",popularity:86,categories:["Leadership"],color:"#34495e"},{id:"v40",name:"Empower",popularity:78,categories:["Leadership"],color:"#16a085"},{id:"v41",name:"Inspire",popularity:89,categories:["Leadership"],color:"#1abc9c"},{id:"v42",name:"Influence",popularity:87,categories:["Leadership"],color:"#27ae60"},{id:"v43",name:"Argue",popularity:72,categories:["Direct Conflict"],color:"#c0392b"},{id:"v44",name:"Fight",popularity:75,categories:["Direct Conflict"],color:"#e74c3c"},{id:"v45",name:"Oppose",popularity:73,categories:["Direct Conflict","Resistance"],color:"#d35400"},{id:"v46",name:"Resist",popularity:75,categories:["Resistance"],color:"#e67e22"},{id:"v47",name:"Disagree",popularity:75,categories:["Resistance"],color:"#f39c12"},{id:"v48",name:"Challenge",popularity:74,categories:["Resistance","Direct Conflict"],color:"#f1c40f"},{id:"v49",name:"Confront",popularity:71,categories:["Direct Conflict"],color:"#c0392b"},{id:"v50",name:"Debate",popularity:76,categories:["Resistance"],color:"#e74c3c"},{id:"v51",name:"Block",popularity:79,categories:["Active Obstruction"],color:"#d35400"},{id:"v52",name:"Prevent",popularity:77,categories:["Active Obstruction"],color:"#e67e22"},{id:"v53",name:"Interrupt",popularity:85,categories:["Active Obstruction"],color:"#f39c12"},{id:"v54",name:"Obstruct",popularity:76,categories:["Active Obstruction","Passive Hindrance"],color:"#f1c40f"},{id:"v55",name:"Hinder",popularity:75,categories:["Passive Hindrance"],color:"#c0392b"},{id:"v56",name:"Restrict",popularity:74,categories:["Passive Hindrance"],color:"#e74c3c"},{id:"v57",name:"Impede",popularity:73,categories:["Passive Hindrance"],color:"#d35400",presentTenseForm:"impede"},{id:"v58",name:"Delay",popularity:78,categories:["Passive Hindrance"],color:"#e67e22"},{id:"v59",name:"Avoid",popularity:74,categories:["Active Evasion"],color:"#f39c12"},{id:"v60",name:"Ignore",popularity:90,categories:["Passive Avoidance"],color:"#f1c40f"},{id:"v61",name:"Withdraw",popularity:68,categories:["Active Evasion"],color:"#c0392b"},{id:"v62",name:"Evade",popularity:70,categories:["Active Evasion"],color:"#e74c3c"},{id:"v63",name:"Deflect",popularity:69,categories:["Active Evasion","Passive Avoidance"],color:"#d35400"},{id:"v64",name:"Withhold",popularity:69,categories:["Passive Avoidance"],color:"#e67e22",presentTenseForm:"withhold"},{id:"v65",name:"Dodge",popularity:71,categories:["Active Evasion"],color:"#f39c12"},{id:"v66",name:"Escape",popularity:72,categories:["Active Evasion"],color:"#f1c40f"},{id:"v67",name:"Criticize",popularity:76,categories:["Criticism"],color:"#7f8c8d"},{id:"v68",name:"Reject",popularity:82,categories:["Rejection"],color:"#95a5a6"},{id:"v69",name:"Dismiss",popularity:78,categories:["Rejection","Criticism"],color:"#bdc3c7"},{id:"v70",name:"Disapprove",popularity:77,categories:["Criticism"],color:"#7f8c8d"},{id:"v71",name:"Dislike",popularity:88,categories:["Rejection"],color:"#95a5a6"},{id:"v72",name:"Condemn",popularity:75,categories:["Criticism"],color:"#bdc3c7"},{id:"v73",name:"Judge",popularity:79,categories:["Criticism"],color:"#7f8c8d"},{id:"v74",name:"Denounce",popularity:74,categories:["Criticism","Rejection"],color:"#95a5a6"}],ls={verbs:Mt},I=s=>{const t=ls.verbs.find(r=>r.id===s);if(t){if(t.presentTenseForm)return t.presentTenseForm;const r=it(t.name).verbs().toPresentTense().out("text").toLowerCase();return r.trim()?r:t.name.toLowerCase()}return s},cs=Ws,ds=Js,Pe=u.forwardRef(({className:s,sideOffset:t=4,...r},a)=>e.jsx(Bs,{children:e.jsx(Je,{ref:a,sideOffset:t,className:z("z-50 min-w-[8rem] rounded-md border bg-white p-2 shadow-md",s),...r})}));Pe.displayName=Je.displayName;const V=u.forwardRef(({className:s,...t},r)=>e.jsx(Qe,{ref:r,className:z("flex cursor-pointer items-center rounded-sm px-2 py-1 text-sm text-gray-700 hover:bg-gray-100",s),...t}));V.displayName=Qe.displayName;const qt=u.forwardRef(({className:s,...t},r)=>e.jsx(Ke,{ref:r,className:z("my-1 h-px bg-gray-200",s),...t}));qt.displayName=Ke.displayName;const $t=({count:s,expanded:t=!1})=>{const r=u.useRef(null),[a,o]=u.useState(!1),i="inline-flex items-center rounded-full px-3 py-1 text-sm transition-colors cursor-pointer whitespace-nowrap max-w-[150px] overflow-hidden",n=s>0?"bg-brand-pink text-white":"bg-gray-100 text-gray-600";let c="";s===0?c="no actions":s===1?c="1 action":c=`${s} actions`,u.useEffect(()=>{if(!r.current)return;const h=r.current;o(h.scrollWidth>h.clientWidth)},[s,c]);const d=a?e.jsx(Qs,{size:16}):c;return e.jsxs("span",{ref:r,className:`${i} ${n}`,children:[d,e.jsx("span",{className:"ml-1",children:t?e.jsx(Xe,{size:16}):e.jsx(Ze,{size:16})})]})},Fe=({initialText:s="",initialDueDate:t="",onSave:r,onCancel:a})=>{const[o,i]=R.useState(s),[n,c]=R.useState(t),d=()=>{o.trim()&&r({text:o.trim(),dueDate:n.trim()||void 0})},h=!o.trim();return e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center cursor-pointer hover:bg-gray-100 gap-1 border border-dashed border-gray-300 p-1 rounded",children:[e.jsx(Y,{placeholder:"Action text",value:o,onChange:m=>i(m.target.value),className:"flex-1"}),e.jsx(Y,{type:"date",value:n,onChange:m=>c(m.target.value),className:"w-36"}),e.jsx(j,{variant:"ghost",size:"sm",onClick:d,disabled:h,className:`m-0 ${h?"text-gray-500":"text-green-500 hover:text-green-700"}`,children:e.jsx(K,{size:16})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:a,className:"text-gray-500 hover:text-gray-700 m-0",children:e.jsx(B,{size:16})})]}),!n.trim()&&e.jsx("div",{className:"text-sm text-gray-500 ml-2 text-right",children:"No due date selected (optional)"})]})},_t=({actions:s,onEditAction:t,onDeleteAction:r,onAddAction:a,onToggleResolved:o})=>{const[i,n]=R.useState(null),[c,d]=R.useState(!1),[h,m]=R.useState({isOpen:!1,actionId:null}),g=N=>{n(N.id)},w=(N,$)=>{t(N,$),n(null)},S=()=>{n(null)},x=()=>{d(!0)},l=N=>{a(N),d(!1)},E=()=>{d(!1)},C=N=>{m({isOpen:!0,actionId:N})},P=()=>{h.actionId&&r(h.actionId),m({isOpen:!1,actionId:null})},A=()=>{m({isOpen:!1,actionId:null})};return e.jsxs("div",{className:"ml-1 pl-3 border-gray-200 space-y-2 mt-2",children:[s.map(N=>{if(i===N.id)return e.jsx(Fe,{initialText:N.action,initialDueDate:N.byDate||"",onSave:y=>w(N.id,y),onCancel:S},N.id);{let y=null;if(N.byDate){const f=lt(N.byDate,"yyyy-MM-dd",new Date);isNaN(f.getTime())||(y=ct(f,"dd/MM/yyyy"))}return e.jsxs("div",{className:`flex items-center justify-between p-2 rounded border shadow-sm transition-colors bg-gray-50 hover:bg-gray-100 ${N.completed?"border-green-500":"border-gray-200"}`,children:[e.jsx("span",{className:"flex-1",children:N.action}),e.jsxs("div",{className:"flex items-center space-x-4",children:[N.completed&&e.jsx(we,{size:18,className:"text-green-600"}),y&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Due: ",y]}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("button",{onClick:f=>f.stopPropagation(),children:e.jsx(es,{size:18,className:"text-gray-500"})})}),e.jsxs(Pe,{align:"end",children:[e.jsxs(V,{onClick:()=>g(N),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(V,{onClick:()=>C(N.id),className:"text-red-600",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Delete"]}),e.jsx(V,{onClick:()=>o&&o(N.id),children:N.completed?e.jsxs(e.Fragment,{children:[e.jsx(Ks,{className:"mr-2 h-4 w-4"}),"Unresolve"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Mark as Resolved"]})})]})]})]})]},N.id)}}),c?e.jsx(Fe,{onSave:l,onCancel:E}):e.jsx("div",{className:"cursor-pointer bg-gray-50 hover:bg-gray-100 border border-dashed border-gray-300 p-2 rounded transition-colors",onClick:x,children:e.jsx("span",{className:"flex-1",children:"+ Add Action"})}),h.isOpen&&e.jsx(is,{isOpen:h.isOpen,onClose:A,onConfirm:P,title:"Delete Action",description:"Are you sure you want to delete this action? This action cannot be undone."})]})},Ft=[{id:"Wellbeing",name:"Wellness at work"},{id:"Parental",name:"My role as a parent and/or carer"},{id:"Religious",name:"My religion or beliefs"},{id:"Disability",name:"Disability & Long-term Conditions"},{id:"Colleague_Sharing",name:"Colleague Sharing"},{id:"Employer_Support",name:"Employer Support"},{id:"Personal_Introduction",name:"Personal Introduction"}],ie={categories:Ft},je=s=>{const t=s?s.toLowerCase():"";return["uncategorized","uncategorised"].includes(t)?"uncategorized":t},ve=s=>{const t=ie.categories.find(r=>je(r.id)===je(s));return t?t.name:["uncategorized","uncategorised"].includes(je(s))?"Uncategorized":Se(s)},Ht=({statement:s,isEditing:t,onPartClick:r,onLocalSave:a,onDelete:o,onEditClick:i,onCancel:n,onEditAction:c=()=>{},onDeleteAction:d=()=>{},onAddAction:h=()=>{},onReset:m,onToggleResolved:g=()=>{},onToggleActionResolved:w=()=>{}})=>{var $;const[S,x]=R.useState(!1),[l,E]=R.useState(s),[C,P]=R.useState(s),[A,N]=R.useState(!1);return u.useEffect(()=>{const y=JSON.parse(JSON.stringify(s));P(y),E(y)},[t,s]),u.useEffect(()=>{t&&E(JSON.parse(JSON.stringify(s)))},[s,s.atoms.subject,s.atoms.verb,s.atoms.object,s.isPublic,s.category,t]),l.atoms.subject,C.atoms.subject,l.atoms.verb,C.atoms.verb,l.atoms.object,C.atoms.object,l.isPublic,C.isPublic,console.log("CATEGORY DEBUG:"),console.log("Draft category:",l.category),console.log("Initial draft category:",C.category),console.log("Normally would be:",l.category!==C.category),console.log("Forcing to true for debugging"),t?e.jsxs("div",{className:"bg-gray-100 p-3 rounded-lg shadow",children:[e.jsxs("div",{className:"hidden md:flex md:items-center md:space-x-2",children:[e.jsx(j,{variant:l.isPublic?"success":"destructive",size:"compact",onClick:()=>{E(y=>{const f=JSON.parse(JSON.stringify(y));return f.isPublic=!y.isPublic,f})},className:"p-2 transition-colors shadow-sm",children:l.isPublic?e.jsx(W,{size:16}):e.jsx(J,{size:16})}),e.jsxs("div",{className:"flex flex-1 items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"flex space-x-2 flex-wrap",children:[e.jsx("div",{onClick:()=>r("subject",l.id),className:"cursor-pointer px-2 py-1 rounded bg-subjectSelector hover:bg-subjectSelectorHover",children:l.atoms.subject}),e.jsx("div",{onClick:()=>r("verb",l.id),className:"cursor-pointer px-2 py-1 rounded bg-verbSelector hover:bg-verbSelectorHover",children:e.jsx("span",{children:I(l.atoms.verb)})}),e.jsx("div",{onClick:()=>r("object",l.id),className:"cursor-pointer px-2 py-1 rounded bg-objectInput hover:bg-objectInputHover",children:l.atoms.object})]}),e.jsxs("div",{onClick:()=>r("category",l.id),className:"cursor-pointer px-2 py-1 rounded bg-categorySelector text-black flex items-center gap-1 hover:bg-categorySelectorHover",children:[e.jsx("span",{className:"mr-1",children:"📁"}),l.category&&l.category.toLowerCase()!=="uncategorized"&&l.category.toLowerCase()!=="uncategorised"?ve(l.category):"Uncategorized"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-auto",children:[e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:"inline-block",children:e.jsx(j,{variant:"success",size:"compact",onClick:async()=>{N(!0);const y={...l};y.input=`${l.atoms.subject} ${I(l.atoms.verb)} ${l.atoms.object}`,await a(y),N(!1)},disabled:A,className:"shadow-sm p-2",children:e.jsx(K,{size:16})})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:"Save changes"})]}),e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:"inline-block",children:e.jsx(j,{variant:"outline",size:"compact",onClick:()=>{E(JSON.parse(JSON.stringify(C))),n&&n(s.id)},className:"p-2",children:e.jsx(be,{size:16})})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:"Cancel editing"})]}),e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:"inline-block",children:e.jsx(j,{variant:"destructive",size:"compact",onClick:()=>o(l.id),className:"shadow-sm p-2",children:e.jsx(ae,{size:16})})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:"Delete statement"})]})]})]}),e.jsxs("div",{className:"hidden sm:flex md:hidden flex-col space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{onClick:()=>r("subject",l.id),className:"cursor-pointer p-2 rounded bg-subjectSelector hover:bg-subjectSelectorHover",children:e.jsx("span",{className:"font-medium",children:l.atoms.subject})}),e.jsx("div",{onClick:()=>r("verb",l.id),className:"cursor-pointer p-2 rounded bg-verbSelector hover:bg-verbSelectorHover",children:e.jsx("span",{className:"font-medium",children:I(l.atoms.verb)})}),e.jsx("div",{onClick:()=>r("object",l.id),className:"cursor-pointer p-2 rounded bg-objectInput hover:bg-objectInputHover",children:e.jsx("span",{className:"font-medium",children:l.atoms.object})}),e.jsxs("div",{onClick:()=>r("category",l.id),className:"cursor-pointer p-2 rounded bg-categorySelector hover:bg-categorySelectorHover flex items-center",children:[e.jsx("span",{className:"mr-1",children:"📁"}),e.jsx("span",{className:"font-medium",children:l.category&&l.category.toLowerCase()!=="uncategorized"&&l.category.toLowerCase()!=="uncategorised"?ve(l.category):"Uncategorized"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-300",children:[e.jsx(j,{variant:l.isPublic?"success":"destructive",size:"compact",onClick:()=>{E(y=>{const f=JSON.parse(JSON.stringify(y));return f.isPublic=!y.isPublic,f})},className:"p-2 transition-colors shadow-sm",children:l.isPublic?e.jsxs(e.Fragment,{children:[e.jsx(W,{size:16}),e.jsx("span",{className:"ml-1 text-xs",children:"Public"})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:16}),e.jsx("span",{className:"ml-1 text-xs",children:"Private"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(j,{variant:"destructive",size:"compact",onClick:()=>o(l.id),className:"px-2 py-1 flex items-center",children:[e.jsx(ae,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-xs",children:"Delete"})]}),e.jsxs(j,{variant:"outline",size:"compact",onClick:()=>{E(JSON.parse(JSON.stringify(C))),n&&n(s.id)},className:"px-2 py-1 flex items-center",children:[e.jsx(be,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-xs",children:"Cancel"})]}),e.jsxs(j,{variant:"success",size:"compact",onClick:async()=>{N(!0);const y={...l};y.input=`${l.atoms.subject} ${I(l.atoms.verb)} ${l.atoms.object}`,await a(y),N(!1)},disabled:A,className:"px-2 py-1 flex items-center",children:[e.jsx(K,{size:16,className:"mr-1"}),e.jsx("span",{className:"text-xs",children:"Save"})]})]})]})]}),e.jsxs("div",{className:"sm:hidden flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("div",{onClick:()=>r("subject",l.id),className:"cursor-pointer p-3 rounded bg-subjectSelector hover:bg-subjectSelectorHover",children:e.jsx("span",{className:"font-medium",children:l.atoms.subject})}),e.jsx("div",{onClick:()=>r("verb",l.id),className:"cursor-pointer p-3 rounded bg-verbSelector hover:bg-verbSelectorHover",children:e.jsx("span",{className:"font-medium",children:I(l.atoms.verb)})}),e.jsx("div",{onClick:()=>r("object",l.id),className:"cursor-pointer p-3 rounded bg-objectInput hover:bg-objectInputHover",children:e.jsx("span",{className:"font-medium",children:l.atoms.object})}),e.jsxs("div",{onClick:()=>r("category",l.id),className:"cursor-pointer p-3 rounded bg-categorySelector hover:bg-categorySelectorHover flex items-center",children:[e.jsx("span",{className:"mr-1",children:"📁"}),e.jsx("span",{className:"font-medium",children:l.category&&l.category.toLowerCase()!=="uncategorized"&&l.category.toLowerCase()!=="uncategorised"?ve(l.category):"Uncategorized"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 mt-2 border-t border-gray-300",children:[e.jsx(j,{variant:l.isPublic?"success":"destructive",size:"compact",onClick:()=>{E(y=>{const f=JSON.parse(JSON.stringify(y));return f.isPublic=!y.isPublic,f})},className:"min-w-[40px] xs:px-3 py-2 flex justify-center",children:l.isPublic?e.jsxs(e.Fragment,{children:[e.jsx(W,{size:16,className:"xs:mr-1"}),e.jsx("span",{className:"hidden xs:inline text-xs",children:"Public"})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:16,className:"xs:mr-1"}),e.jsx("span",{className:"hidden xs:inline text-xs",children:"Private"})]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(j,{variant:"destructive",size:"compact",onClick:()=>o(l.id),className:"min-w-[40px] xs:px-3 py-2 flex justify-center",children:[e.jsx(ae,{size:16,className:"xs:mr-1"}),e.jsx("span",{className:"hidden xs:inline text-xs",children:"Delete"})]}),e.jsxs(j,{variant:"outline",size:"compact",onClick:()=>{E(JSON.parse(JSON.stringify(C))),n&&n(s.id)},className:"min-w-[40px] xs:px-3 py-2 flex justify-center",children:[e.jsx(be,{size:16,className:"xs:mr-1"}),e.jsx("span",{className:"hidden xs:inline text-xs",children:"Cancel"})]}),e.jsxs(j,{variant:"success",size:"compact",onClick:async()=>{N(!0);const y={...l};y.input=`${l.atoms.subject} ${I(l.atoms.verb)} ${l.atoms.object}`,await a(y),N(!1)},disabled:A,className:"min-w-[40px] xs:px-3 py-2 flex justify-center",children:[e.jsx(K,{size:16,className:"xs:mr-1"}),e.jsx("span",{className:"hidden xs:inline text-xs",children:"Save"})]})]})]})]})]}):e.jsxs("div",{className:`border rounded-md p-3 space-y-2 relative ${s.isResolved?"bg-gray-100 border-gray-300 opacity-80":"bg-white border-gray-200 shadow-sm"}`,children:[s.isResolved&&e.jsxs("span",{className:"absolute -top-2 -right-2 bg-gray-200 text-gray-600 text-xs gap-1 px-2 py-0.5 rounded-full flex",children:[e.jsx(Re,{size:14}),"Archived"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:`inline-flex items-center justify-center ${s.isPublic?"text-green-500":"text-red-500"} ${s.isResolved?"opacity-70":""}`,children:s.isPublic?e.jsx(W,{size:16}):e.jsx(J,{size:16})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:s.isPublic?"You are sharing this statement":"This statement is private"})]}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:s.isResolved?"text-gray-500":"",children:`${s.atoms.subject} ${I(s.atoms.verb)} ${s.atoms.object}`})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[s.isResolved&&e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{className:"inline-flex items-center justify-center text-green-600",children:e.jsx(we,{size:18})})}),e.jsx(M,{className:"p-2 bg-black text-white rounded",children:"This statement is resolved."})]}),e.jsx("div",{onClick:()=>x(y=>!y),className:"cursor-pointer",children:e.jsx($t,{count:(($=s.actions)==null?void 0:$.length)??0,expanded:S})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx("button",{onClick:y=>y.stopPropagation(),children:e.jsx(es,{size:18,className:"text-gray-500"})})}),e.jsxs(Pe,{align:"end",children:[e.jsxs(V,{onClick:()=>i(s.id),children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(V,{onClick:()=>o(s.id),className:"text-red-600",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Delete"]}),e.jsx(V,{onClick:()=>g(s.id),children:s.isResolved?e.jsxs(e.Fragment,{children:[e.jsx(Xs,{className:"mr-2 h-4 w-4 text-red-500"}),"Unarchive"]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"mr-2 h-4 w-4 text-green-500"}),"Archive"]})}),m&&e.jsxs(V,{onClick:()=>m(s.id),children:[e.jsx(Zs,{className:"mr-2 h-4 w-4"}),"Reset"]})]})]})]})]}),S&&e.jsx("div",{className:"mt-2",children:e.jsx(_t,{actions:s.actions??[],onEditAction:(y,f)=>c&&c(s.id,y,f),onDeleteAction:y=>d&&d(s.id,y),onAddAction:y=>h&&h(s.id,y),onToggleResolved:y=>w&&w(y)})})]})},ze=void 0;console.log("Backend API:",ze);async function Yt(s){try{const t=await fetch(`${ze}/write`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error(`HTTP error on POST! status: ${t.status}`);const r=await t.json();console.log("Successfully posted entry:",r)}catch(t){console.error("Error posting new entry:",t)}}async function G(s){try{const t=await fetch(`${ze}/updateEntry`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error(`HTTP error on update! status: ${t.status}`);const r=await t.json();console.log("Successfully updated entry:",r)}catch(t){console.error("Error updating entry:",t)}}const se=({subQuestion:s,showBack:t=!1,onBack:r,children:a,currentStep:o=1,totalSteps:i=5})=>e.jsxs("div",{className:"p-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[t&&r&&e.jsx(j,{variant:"outline",size:"compact",onClick:r,className:"mr-2 p-2",children:e.jsx(et,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full border border-gray-300 bg-gray-50 mr-2",children:e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:[o,"/",i]})}),e.jsx("h2",{className:"text-md font-medium text-gray-700",children:s})]})]}),a]}),Vt=[{name:"wellbeing",description:"Descriptors related to the user's mental and emotional state, including stress, energy, and overall wellbeing.",options:["mental state","emotional balance","stress levels","energy levels"]},{name:"parental",description:"Descriptors related to parental or caring responsibilities.",options:["family responsibilities","child care","elder care","primary carer"]},{name:"religious",description:"Descriptors related to religious practices, beliefs, or related needs such as dietary or prayer requirements.",options:["religious practice","spirituality","dietary requirements","prayer needs"]},{name:"disability",description:"Descriptors that capture the impact of a disability or long-term condition on the user, including accessibility and health needs.",options:["physical limitations","accessibility needs","chronic condition","assistive technology"]},{name:"colleagueSharing",description:"Descriptors regarding the type and level of information the user is comfortable sharing with colleagues.",options:["detailed sharing","summarized sharing","anonymous","private"]},{name:"employerSupport",description:"Descriptors regarding the user's support and communication preferences from the employer.",options:["formal check-ins","informal chats","regular feedback","as-needed support"]},{name:"personalIntroduction",description:"Descriptors for personal introduction details that capture background, hobbies, ambitions, and other personal insights.",options:["family background","career journey","personal hobbies","ambitions","cultural background"]}],Gt={descriptors:Vt},Bt=(s,t)=>{let r=[];const a=(t==null?void 0:t.category)||"wellbeing",i=Gt.descriptors.find(n=>n.name.toLowerCase()===a.toLowerCase());return i&&(r=i.options),[{label:s,value:s},...r.map(n=>({label:`${s}'s ${n}`,value:`${s}'s ${n}`}))]},Wt=({username:s,activePresetQuestion:t,selectedValue:r,onSelect:a})=>{const o=u.useMemo(()=>Bt(s,t),[s,t]);return e.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[60vh] overflow-y-auto p-2",children:o.map(i=>e.jsx(j,{variant:"outline",selected:r===i.value,className:`h-auto py-4 px-6 text-left flex flex-col items-start space-y-1  
      
          `,onClick:()=>a(i.value),style:{"--tile-color":"var(--subject-selector)"},children:e.jsx("span",{className:"font-medium",children:i.label})},i.value))})},us=({username:s,presetQuestion:t,selection:r,onUpdate:a,currentStep:o=1,totalSteps:i=5})=>{var d,h;const n=`This statement applies to ${s} or someone/something else?`,c=(h=(d=t==null?void 0:t.steps)==null?void 0:d.subject)==null?void 0:h.allowDescriptors;return e.jsx(se,{subQuestion:n,currentStep:o,totalSteps:i,children:c===!1?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center p-4 border rounded",children:e.jsx("p",{children:s})})}):e.jsx(Wt,{username:s,activePresetQuestion:t,selectedValue:r,onSelect:m=>{a(m)}})})},Jt={id:"verb_categories",name:"Verb Categories",displayName:"Verb Categories",color:"#ffffff",icon:"🔥",children:[{id:"positive",name:"Positive",displayName:"Positive",color:"#2c3e50",icon:"🌟",children:[{id:"communication",name:"Communication",displayName:"Communication",color:"#007BFF",icon:"💬"},{id:"support_assistance",name:"Support & Assistance",displayName:"Support & Assistance",color:"#34495f",icon:"🤝",children:[{id:"support_help",name:"Support & Help",displayName:"Support & Help",color:"#3498db",icon:"💪"},{id:"guide_encourage",name:"Guide & Encourage",displayName:"Guide & Encourage",color:"#2980b9",icon:"🧭"}]},{id:"growth_development",name:"Growth & Development",displayName:"Growth & Development",color:"#16a085",icon:"🌱",children:[{id:"personal_growth",name:"Personal Growth",displayName:"Personal Growth",color:"#1abc9c",icon:"📈"},{id:"adaptation_learning",name:"Adaptation & Learning",displayName:"Adaptation & Learning",color:"#27ae60",icon:"🧠"}]},{id:"innovation_creation",name:"Innovation & Creation",displayName:"Innovation & Creation",color:"#8e44ad",icon:"💡",children:[{id:"creative_process",name:"Creative Process",displayName:"Creative Process",color:"#9b59b6",icon:"🎨"},{id:"implementation",name:"Implementation",displayName:"Implementation",color:"#7d3c98",icon:"🛠️"}]},{id:"collaboration_connection",name:"Collaboration & Connection",displayName:"Collaboration & Connection",color:"#2980b9",icon:"🤝",children:[{id:"teamwork",name:"Teamwork",displayName:"Teamwork",color:"#3498db",icon:"👥"},{id:"engagement",name:"Engagement",displayName:"Engagement",color:"#2c3e50",icon:"🔗"}]},{id:"leadership",name:"Leadership",displayName:"Leadership",color:"#8A2BE2",icon:"👑"},{id:"achievement",name:"Achievement",displayName:"Achievement",color:"#F1C40F",icon:"🏆"}]},{id:"negative",name:"Negative",displayName:"Negative",color:"#c0392b",icon:"⚠️",children:[{id:"conflict_opposition",name:"Conflict & Opposition",displayName:"Conflict & Opposition",color:"#e74c3c",icon:"⚔️",children:[{id:"direct_conflict",name:"Direct Conflict",displayName:"Direct Conflict",color:"#c0392b",icon:"🥊"},{id:"resistance",name:"Resistance",displayName:"Resistance",color:"#d35400",icon:"🛡️"}]},{id:"obstruction_hindrance",name:"Obstruction & Hindrance",displayName:"Obstruction & Hindrance",color:"#e67e22",icon:"🚧",children:[{id:"active_obstruction",name:"Active Obstruction",displayName:"Active Obstruction",color:"#d35400",icon:"🛑"},{id:"passive_hindrance",name:"Passive Hindrance",displayName:"Passive Hindrance",color:"#f39c12",icon:"🐌"}]},{id:"evasion_avoidance",name:"Evasion & Avoidance",displayName:"Evasion & Avoidance",color:"#f39c12",icon:"🏃",children:[{id:"active_evasion",name:"Active Evasion",displayName:"Active Evasion",color:"#e67e22",icon:"💨"},{id:"passive_avoidance",name:"Passive Avoidance",displayName:"Passive Avoidance",color:"#d35400",icon:"🙈"}]},{id:"criticism_rejection",name:"Criticism & Rejection",displayName:"Criticism & Rejection",color:"#7f8c8d",icon:"👎",children:[{id:"criticism",name:"Criticism",displayName:"Criticism",color:"#95a5a6",icon:"🔍"},{id:"rejection",name:"Rejection",displayName:"Rejection",color:"#bdc3c7",icon:"❌"}]}]}]},ms={root:Jt},de=s=>{const t=Number.parseInt(s.slice(1,3),16),r=Number.parseInt(s.slice(3,5),16),a=Number.parseInt(s.slice(5,7),16);return(t*299+r*587+a*114)/1e3>=128?"black":"white"},Qt=({rootCategory:s,currentCategory:t,path:r,onSelectCategory:a,onBreadcrumbClick:o})=>{const i=s.children??[];return e.jsxs("div",{className:"flex flex-col border rounded-md ",children:[e.jsx("div",{className:"px-3 py-1.5 bg-gray-100 border-b flex items-center",children:e.jsxs("div",{className:"flex items-center flex-wrap",children:[e.jsx("h3",{className:"text-xs font-medium text-gray-700 mr-1",children:"Filters:"}),e.jsx("span",{onClick:()=>o(-1),className:`cursor-pointer px-2 py-0.5 rounded text-xs font-medium transition-colors
              ${r.length===0?"bg-brand-pink text-white":"text-gray-600 hover:bg-gray-100"}`,children:"All"}),r.map((n,c)=>e.jsxs(R.Fragment,{children:[e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-400 mx-0.5",children:e.jsx("path",{d:"M9 6L15 12L9 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("span",{onClick:()=>o(c),className:"cursor-pointer px-1.5 py-0.5 rounded text-xs font-medium transition-colors flex items-center",style:{backgroundColor:c===r.length-1?n.color:void 0,color:c===r.length-1?de(n.color):"inherit"},children:n.displayName})]},n.id))]})}),e.jsxs("div",{className:"bg-gray-50 px-3 py-1 flex-1",children:[!t&&e.jsx("div",{className:"grid grid-cols-3 gap-1.5 sm:grid-cols-4 md:grid-cols-5 justify-items-center",children:i.map(n=>e.jsxs("button",{onClick:()=>a(n),className:"flex flex-col items-center justify-center gap-1 p-1.5 rounded hover:bg-gray-100 transition-colors text-center w-full max-w-[90px]",style:{color:de(n.color)},children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center rounded-sm",style:{backgroundColor:n.color},children:n.icon||"•"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 line-clamp-1",children:n.displayName})]},n.id))}),t&&t.children&&t.children.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-1.5 sm:grid-cols-4 md:grid-cols-5 justify-items-center",children:t.children.map(n=>e.jsxs("button",{onClick:()=>a(n),className:"flex flex-col items-center justify-center gap-1 p-1.5 rounded hover:bg-gray-100 transition-colors text-center w-full max-w-[90px]",style:{color:de(n.color)},children:[e.jsx("div",{className:"w-6 h-6 flex items-center justify-center rounded-sm",style:{backgroundColor:n.color},children:n.icon||"•"}),e.jsx("span",{className:"text-xs font-medium text-gray-700 line-clamp-1",children:n.displayName})]},n.id))}),t&&(!t.children||t.children.length===0)&&e.jsx("div",{className:"flex items-center justify-center py-1 text-xs text-gray-500",children:"No subcategories"})]})]})};function Kt(){return ms.root}function ps(s,t){if(s.name===t)return s;if(s.children)for(const r of s.children){const a=ps(r,t);if(a)return a}return null}function hs(s){const t=[s.name];if(s.children)for(const r of s.children)t.push(...hs(r));return t}function Xt(s,t=Kt()){for(const r of s.categories){const a=ps(t,r);if(a)return a.color}return"transparent"}const Zt=({verbs:s,rootCategory:t,selectedVerbId:r,onVerbSelect:a})=>{const o=[...s].sort((i,n)=>i.name.localeCompare(n.name));return e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-4 p-4 overflow-auto border",children:o.map(i=>{const n=Xt(i,t),c=i.id===r;return e.jsx(j,{onClick:()=>a(i),variant:"outlineVerbs",selected:c,className:"flex items-center justify-center p-4 rounded-lg shadow-md",style:{"--tile-color":n,color:c?de(n):"inherit",borderColor:n},children:e.jsx("span",{className:"font-medium",children:i.name})},i.name)})})},er=({selectedVerbId:s,onVerbSelect:t})=>{const[r,a]=u.useState([]),o=ms.root,i=r.length>0?r[r.length-1]:null,n=m=>{a([...r,m])},c=m=>{a(m===-1?[]:r.slice(0,m+1))};let d=[];i&&(d=hs(i));const h=ls.verbs.filter(m=>i?m.categories.some(g=>d.includes(g)):!0);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(Qt,{rootCategory:o,currentCategory:i,path:r,onSelectCategory:n,onBreadcrumbClick:c}),e.jsx(Zt,{verbs:h,rootCategory:o,selectedVerbId:s,onVerbSelect:t})]})},gs=({subject:s,selection:t,onUpdate:r,currentStep:a=2,totalSteps:o=5})=>{const i=`What's happening with ${s}? How do they feel or what do they experience?`;return e.jsx(se,{subQuestion:i,currentStep:a,totalSteps:o,children:e.jsx("div",{className:"flex flex-col h-[60vh] p-4 rounded-md",children:e.jsx(er,{selectedVerbId:t,onVerbSelect:n=>{r(n.id)}})})})},xs=({subject:s,verb:t,selection:r,onUpdate:a,currentStep:o=3,totalSteps:i=5})=>{const n=`In what way does ${s} ${I(t)}? What's the context?`;return e.jsx(se,{subQuestion:n,showBack:!0,currentStep:o,totalSteps:i,children:e.jsx("div",{className:"p-4 rounded-md",children:e.jsx(Y,{autoFocus:!0,placeholder:"Type your answer...",value:r,onChange:c=>a(c.target.value),className:"text-lg p-4 rounded"})})})},fs=({selection:s,onUpdate:t,currentStep:r=4,totalSteps:a=5})=>{const o="You can set a category for your statement",i=ie.categories||[],n=h=>h?h.toLowerCase():"",c=n(s),d=!s||c==="uncategorised"||c==="uncategorized";return e.jsx(se,{subQuestion:o,showBack:!0,currentStep:r,totalSteps:a,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 max-h-[60vh] overflow-y-auto p-2",children:[i.map(h=>e.jsx(j,{onClick:()=>t(h.id),variant:"outline",selected:c===n(h.id),className:"h-auto py-4 px-6 text-left flex flex-col items-start transition-all whitespace-normal break-words",style:{"--tile-color":"var(--category-selector)"},children:e.jsx("span",{className:"font-medium",children:h.name})},h.id)),e.jsx(j,{onClick:()=>t("uncategorized"),variant:"outline",selected:d,className:"h-auto py-4 px-6 text-left flex flex-col items-start transition-all whitespace-normal break-words",style:{"--tile-color":"var(--category-selector)"},children:e.jsx("span",{className:"font-medium",children:"Uncategorised"})})]})})},ys=({isPublic:s,onUpdate:t,isSubmitting:r=!1,currentStep:a=5,totalSteps:o=5})=>e.jsx(se,{subQuestion:"Who can see this statement?",showBack:!0,currentStep:a,totalSteps:o,children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(j,{variant:"outline",selected:!s,disabled:r,className:"w-full h-auto p-4 flex items-center justify-between",onClick:()=>t(!1),style:{"--tile-color":"var(--privacy-selector)"},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Private"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Only you can see this"})]})]})}),e.jsx(j,{variant:"outline",selected:s,disabled:r,className:"w-full h-auto p-4 flex items-center justify-between",onClick:()=>t(!0),style:{"--tile-color":"var(--privacy-selector)"},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(W,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Public"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Everyone can see this"})]})]})})]})})}),sr=({currentStep:s=5,totalSteps:t=5})=>e.jsx(se,{subQuestion:"Add additional statement if needed",currentStep:s,totalSteps:t,children:e.jsx("div",{className:"text-center p-4",children:e.jsx("p",{className:"text-lg",children:"If you feel your statement didn't fully answer the question, you can later create your own statements to complement it."})})}),tr=({selection:s})=>{const{subject:t,verb:r,object:a,adverbial:o}=s.atoms,{isPublic:i,category:n}=s,c=s.currentStep??"privacy",d=!!t.trim(),h=c==="privacy"||c==="complement",m=c==="category"||c==="privacy"||c==="complement",g=w=>{if(!w)return"";const S=w.toLowerCase();if(S==="uncategorized"||S==="uncategorised")return"Uncategorised";const x=ie.categories.find(l=>l.id.toLowerCase()===S);return x?x.name:w};return d?e.jsxs("div",{className:"w-full pl-2 pr-4 mt-3 -mb-1 flex flex-wrap gap-1.5 items-center justify-start",children:[e.jsxs("div",{className:"flex items-center mr-1 text-gray-500",children:[e.jsx(st,{size:12,className:"mr-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Statement:"})]}),t&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded bg-subjectSelector text-black",children:t}),r&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded bg-verbSelector text-black",children:I(r)}),a&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded bg-objectInput text-black",children:a}),m&&n&&e.jsxs("span",{className:"px-1.5 py-0.5 text-xs rounded bg-categorySelector text-black flex items-center gap-1",children:[e.jsx("span",{className:"mr-1",children:"📁"}),g(n)]}),h&&e.jsx("span",{className:`ml-0.5 flex-shrink-0 ${i?"text-green-500":"text-red-500"}`,children:i?e.jsx(W,{size:14}):e.jsx(J,{size:14})}),o&&o.length>0&&o.map((w,S)=>e.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded bg-gray-400 text-black",children:w},S))]}):null},bs=({username:s,presetQuestion:t,onComplete:r,onClose:a})=>{const{setData:o}=q(),n=!!t?["subject","verb","object","privacy","complement"]:["subject","verb","object","category","privacy"],c={subject:"border-[var(--subject-selector)]",verb:"border-[var(--verb-selector)]",object:"border-[var(--object-input)]",category:"border-[var(--category-selector)]",privacy:"border-[var(--privacy-selector)]",complement:"border-gray-400"},[d,h]=u.useState(0),[m,g]=u.useState({id:"",input:"",isPublic:!1,atoms:{subject:"",verb:"",object:"",adverbial:[]},category:""}),[w,S]=u.useState(!1),[x,l]=u.useState(!1);u.useEffect(()=>{var f,D;(D=(f=t==null?void 0:t.steps)==null?void 0:f.subject)!=null&&D.preset?g(_=>({..._,atoms:{..._.atoms,subject:s}})):g(_=>({..._,atoms:{..._.atoms,subject:s},category:"uncategorised"}))},[t,s]);const E=n[d],C=async()=>{if(w)return;S(!0);const{subject:f,verb:D,object:_,adverbial:te}=m.atoms,le=te&&te.length>0?te.join(" "):"",he=`${f} ${D} ${_}${le?" "+le:""}`,re={...m,id:Date.now().toString(),input:he,presetId:t?t.id:void 0,category:(t==null?void 0:t.category)||m.category||"Uncategorized"};try{o({type:"ADD_ENTRY",payload:re}),await Yt(re),r(re),a()}catch(ge){console.error("Submission failed",ge)}finally{S(!1)}},P=()=>{x||(l(!0),setTimeout(()=>{d<n.length-1?h(f=>f+1):C(),setTimeout(()=>{l(!1)},300)},200))},A=()=>{d>0?h(f=>f-1):a()},N=f=>{switch(f){case"subject":return m.atoms.subject.trim().length>0;case"verb":return m.atoms.verb.trim().length>0;case"object":return m.atoms.object.trim().length>0;case"category":return m.category.trim().length>0;case"privacy":return!0;case"complement":return!0;default:return!1}},$=()=>{switch(E){case"subject":return e.jsx(us,{username:s,presetQuestion:t,selection:m.atoms.subject,onUpdate:f=>{m.atoms.subject===f?P():g(D=>({...D,atoms:{...D.atoms,subject:f}}))}});case"verb":return e.jsx(gs,{subject:m.atoms.subject,selection:m.atoms.verb,onUpdate:f=>{m.atoms.verb===f?P():g(D=>({...D,atoms:{...D.atoms,verb:f}}))}});case"object":return e.jsx(xs,{subject:m.atoms.subject,verb:m.atoms.verb,selection:m.atoms.object,onUpdate:f=>{m.atoms.object===f?P():g(D=>({...D,atoms:{...D.atoms,object:f}}))}});case"category":return e.jsx(fs,{selection:m.category,onUpdate:f=>{m.category===f?P():g(D=>({...D,category:f}))}});case"privacy":return e.jsx(ys,{isPublic:m.isPublic,onUpdate:f=>{m.isPublic===f?P():g(D=>({...D,isPublic:f}))}});case"complement":return e.jsx(sr,{});default:return null}},y=f=>c[f];return e.jsx(X,{open:!0,onOpenChange:a,children:e.jsxs(Z,{className:`sm:max-w-[600px] p-0 w-full border-8 ${y(E)}`,children:[t&&e.jsx("div",{className:"px-4 py-3 bg-gray-200 border-b",children:e.jsx("h2",{className:"text-xl font-bold",children:t.mainQuestion})}),e.jsx(ee,{className:"sr-only",children:"Wizard Steps"}),e.jsx(me,{className:"sr-only",children:"Wizard Steps"}),e.jsx(dt,{mode:"wait",initial:!1,children:e.jsx(ut.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:$()},E)}),e.jsxs("div",{className:"flex justify-center p-4 pb-4 mb-0 gap-4",children:[e.jsx(j,{onClick:A,disabled:d===0,variant:"outline",className:"shadow-sm",children:e.jsx("span",{children:"Back"})}),e.jsx(j,{variant:"default",className:"shadow-sm",onClick:d===n.length-1?C:P,disabled:!N(E)||w,children:e.jsx("span",{children:w?"Submitting...":d===n.length-1?"Create Statement":"Next"})})]}),e.jsx(tr,{selection:{...m,currentStep:E}})]})})},rr=({statement:s,editPart:t,username:r,onUpdate:a,onClose:o})=>{const[i,n]=u.useState(()=>{switch(t){case"subject":return s.atoms.subject;case"verb":return s.atoms.verb;case"object":return s.atoms.object;case"category":return s.category;case"privacy":return s.isPublic;default:return""}}),c=()=>{let g;if(t==="subject"||t==="verb"||t==="object"){g={...s,atoms:{...s.atoms,[t]:i}};const w={...s.atoms,[t]:i};g.input=`${w.subject} ${I(w.verb)} ${w.object}`}else t==="category"?(console.log("EDIT STATEMENT MODAL - Setting category:"),console.log("Original statement category:",s.category),console.log("New category value:",i),g=JSON.parse(JSON.stringify({...s,category:i})),console.log("Updated statement:",g)):t==="privacy"?g={...s,isPublic:i}:g=s;a(g),o()},h={subject:"border-[var(--subject-selector)]",verb:"border-[var(--verb-selector)]",object:"border-[var(--object-input)]",category:"border-[var(--category-selector)]",privacy:"border-[var(--privacy-selector)]",complement:"border-gray-400"}[t]||"border-gray-400",m=()=>{switch(t){case"subject":return e.jsx(us,{username:r,presetQuestion:{id:"editing",category:s.category||"wellbeing",mainQuestion:"",steps:{subject:{question:"",preset:!1,presetAnswer:null,allowDescriptors:!0},verb:{question:"",preset:!1,presetAnswer:null},object:{question:"",preset:!1,presetAnswer:null},privacy:{question:"",preset:!1,presetAnswer:null}}},selection:i,onUpdate:g=>{g===i?c():n(g)}});case"verb":return e.jsx(gs,{subject:s.atoms.subject,selection:i,onUpdate:g=>{g===i?c():n(g)}});case"object":return e.jsx(xs,{subject:s.atoms.subject,verb:s.atoms.verb,selection:i,onUpdate:g=>{g===i?c():n(g)}});case"category":return e.jsx(fs,{selection:i,onUpdate:g=>{g===i?c():n(g)}});case"privacy":return e.jsx(ys,{isPublic:i,onUpdate:g=>{g===i?c():n(g)}});default:return null}};return e.jsx(X,{open:!0,onOpenChange:o,children:e.jsxs(Z,{className:`sm:max-w-[600px] p-0 w-full border-8 ${h}`,children:[e.jsxs(me,{children:["Edit ",t]}),e.jsxs(ee,{className:"sr-only",children:["Edit the ",t," of your statement."]}),m(),e.jsxs("div",{className:"p-4 flex justify-center gap-4",children:[e.jsx(j,{onClick:c,variant:"default",className:"inline-flex items-center shadow-sm",children:"OK"}),e.jsx(j,{onClick:o,variant:"outline",className:"inline-flex items-center",children:"Cancel"})]})]})})},Q=s=>{const t=s?s.toLowerCase():"";return["uncategorized","uncategorised"].includes(t)?"uncategorized":t},js=s=>{const t=Q(s),r=ie.categories.find(a=>Q(a.id)===t);return r?r.id:s},ar=s=>s.reduce((t,r)=>{const a=js(r.category||"Uncategorized");return t[a]||(t[a]=[]),t[a].push(r),t},{}),nr=s=>s.reduce((t,r)=>{const a=js(r.category||"Uncategorized");return t[a]||(t[a]=[]),t[a].push(r),t},{}),or=({username:s})=>{const{data:t,setData:r}=q(),{entries:a}=t,[o,i]=u.useState([]),{questions:n,setQuestions:c}=Te(),d=n.filter(p=>!o.includes(p.id)&&!p.isSnoozed),h=ar(d),m=nr(a),g=ie.categories,[w,S]=u.useState({isOpen:!1,statementId:null}),[x,l]=u.useState(!1),[E,C]=u.useState(null),[P,A]=u.useState(null),[N,$]=u.useState(null),[y,f]=u.useState({}),D=p=>{const v=a.find(k=>k.id===p);if(!v)return;const b={...v,isResolved:!v.isResolved};r({type:"UPDATE_ENTRY",payload:b}),G(b)},_=p=>{if(!n.find(k=>k.id===p))return;const b=n.map(k=>k.id===p?k.isSnoozed?{...k,isSnoozed:!1,category:k.originalCategory||k.category}:{...k,isSnoozed:!0,originalCategory:k.category,category:"snoozed"}:k);c(b)},te=(p,v)=>{const b=a.find(T=>T.id===p);if(!b||!b.actions)return;const k=b.actions.map(T=>T.id===v?{...T,completed:!T.completed}:T),U={...b,actions:k};r({type:"UPDATE_ENTRY",payload:U}),G(U)};async function le(p){try{await G(p),r({type:"UPDATE_ENTRY",payload:p}),f(v=>{const b={...v};return delete b[p.id],b}),A(null)}catch(v){console.error("Error saving statement to DB:",v)}}const he=p=>{C(p),l(!0)},re=p=>{E&&i(v=>[...v,E.id]),l(!1),C(null)},ge=()=>{l(!1),C(null)},vs=p=>{S({isOpen:!0,statementId:p})},ws=()=>{w.statementId&&r({type:"DELETE_ENTRY",payload:w.statementId}),S({isOpen:!1,statementId:null})},Ns=()=>{S({isOpen:!1,statementId:null})},Ss=p=>{const v=a.find(b=>b.id===p);v&&f(b=>({...b,[p]:JSON.parse(JSON.stringify(v))})),A(p)},ks=(p,v)=>{const b=a.find(k=>k.id===v);b&&$({statement:b,editPart:p})},Cs=p=>{const v=a.find(b=>b.id===p);v&&v.presetId&&(r({type:"DELETE_ENTRY",payload:p}),i(b=>b.filter(k=>k!==v.presetId)))},Es=(p,v)=>{const b=a.find(O=>O.id===p);if(!b)return;const k={id:Date.now().toString(),creationDate:new Date().toISOString(),byDate:v.dueDate||"",action:v.text,completed:!1},U=b.actions?[...b.actions,k]:[k],T={...b,actions:U};r({type:"UPDATE_ENTRY",payload:T}),G(T)},As=(p,v,b)=>{const k=a.find(O=>O.id===p);if(!k||!k.actions)return;const U=k.actions.map(O=>O.id===v?{...O,action:b.text,byDate:b.dueDate||O.byDate}:O),T={...k,actions:U};r({type:"UPDATE_ENTRY",payload:T}),G(T)},Ds=(p,v)=>{const b=a.find(T=>T.id===p);if(!b||!b.actions)return;const k=b.actions.filter(T=>T.id!==v),U={...b,actions:k};r({type:"UPDATE_ENTRY",payload:U}),G(U)},[xe,Ts]=u.useState(!1),Oe=(p,v)=>{if(p==="snoozed")return null;const b=h[p]||[],k=m[p]||[];if(b.length===0&&k.length===0)return null;const U=Q(p),{categoryCounts:T}=Pt(),O=T[U]||{answered:0,total:0},Le=O.total>0&&O.answered===O.total;return e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"relative z-10",children:e.jsx("div",{className:`inline-block px-4 py-2 rounded-t-lg ${Le?"bg-green-200 border-green-500":"bg-slate-100 border-slate-300"} border-t border-l border-r border-b-0`,children:e.jsx("h3",{className:"text-lg font-semibold",children:Se(v)})})}),e.jsxs("div",{className:`border rounded-tr-lg rounded-b-lg p-4 -mt-[1px] ${Le?"bg-white border-green-500":"bg-white border-slate-300"}`,children:[b.length>0&&e.jsx("ul",{className:"space-y-2",children:b.map(L=>e.jsx("li",{children:e.jsx(_e,{presetQuestion:L,onSelect:he,onToggleSnooze:_})},`preset-${L.id}`))}),k.length>0&&e.jsx("ul",{className:"space-y-4 mt-4",children:k.map(L=>e.jsx("li",{children:e.jsx(Ht,{statement:L,isEditing:L.id===P,editingPart:null,onPartClick:ks,onLocalSave:le,onCancel:()=>{y[L.id]&&(r({type:"UPDATE_ENTRY",payload:y[L.id]}),f(ye=>{const Ie={...ye};return delete Ie[L.id],Ie})),A(null)},onDelete:vs,onEditClick:Ss,onAddAction:Es,onEditAction:As,onDeleteAction:Ds,onReset:L.presetId?()=>Cs(L.id):void 0,onToggleResolved:D,onToggleActionResolved:ye=>te(L.id,ye)})},L.id))})]})]},p)},Ps=()=>{const p=n.filter(v=>v.isSnoozed);return p.length===0?null:e.jsxs("div",{className:"mb-8 mt-4",children:[e.jsx("div",{className:"relative z-10",children:e.jsx("div",{className:"inline-block px-4 py-2 rounded-t-lg bg-blue-100 border-blue-300 border-t border-l border-r border-b-0 cursor-pointer",onClick:()=>Ts(!xe),children:e.jsxs("div",{className:"flex items-center justify-between min-w-[200px]",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center text-blue-700",children:[e.jsx(We,{className:"h-5 w-5 mr-2"}),"Snoozed Questions"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"mr-2 text-blue-700",children:["(",p.length,")"]}),xe?e.jsx(Xe,{className:"h-5 w-5 text-blue-600"}):e.jsx(Ze,{className:"h-5 w-5 text-blue-600"})]})]})})}),xe&&e.jsx("div",{className:"border rounded-tr-lg rounded-b-lg p-4 -mt-[1px] bg-white border-blue-300",children:e.jsx("ul",{className:"space-y-2",children:p.map(v=>e.jsx("li",{children:e.jsx(_e,{presetQuestion:v,onSelect:()=>{},onToggleSnooze:_})},`snoozed-${v.id}`))})})]})},fe=g,zs=fe.map(p=>p.id),Os=Array.from(new Set([...Object.keys(h),...Object.keys(m)])).filter(p=>!zs.includes(p)),Ls=p=>{const v=fe.find(b=>Q(b.id)===Q(p));return v?v.name:["uncategorized","uncategorised"].includes(Q(p))?"Uncategorized":Se(p)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-lg p-6 w-full",children:[fe.map(p=>Oe(p.id,p.name)),Os.map(p=>Oe(p,Ls(p))),Ps(),e.jsx(is,{isOpen:w.isOpen,onClose:Ns,onConfirm:ws,title:"Delete Statement",description:"Are you sure you want to delete this statement? This action cannot be undone."})]}),x&&E&&e.jsx(bs,{username:s,presetQuestion:E,onComplete:re,onClose:ge}),N&&e.jsx(rr,{statement:N.statement,editPart:N.editPart,username:s,onUpdate:p=>{P===p.id?r({type:"UPDATE_ENTRY",payload:p}):(r({type:"UPDATE_ENTRY",payload:p}),G(p))},onClose:()=>$(null)})]})};async function ir(s){try{const t=await fetch("/api/email/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok){const r=await t.json();throw new Error(r.message||"Failed to send email")}return await t.json()}catch(t){throw console.error("Error sending email:",t),t}}const lr=({onClose:s})=>{const{data:t}=q(),{username:r,managerName:a,managerEmail:o}=t,[i,n]=u.useState(!1),[c,d]=u.useState(null),[h,m]=u.useState(!1),g=t.entries.filter(x=>x.isPublic&&!x.isResolved),w=()=>{let x=`
      <h1 style="color: #333; font-size: 24px; margin-bottom: 20px;">Statements from ${r}</h1>
      <p style="font-size: 16px; margin-bottom: 30px;">
        ${r} would like to share the following statements with you:
      </p>
    `;return g.forEach(l=>{if(x+=`
        <div style="margin-bottom: 25px; padding: 15px; border-left: 4px solid #ff69b4; background-color: #f9f9f9;">
          <p style="font-weight: bold; font-size: 18px; margin-bottom: 10px;">
            ${l.atoms.subject} ${I(l.atoms.verb)} ${l.atoms.object}
          </p>
      `,l.actions&&l.actions.length>0){const E=l.actions.filter(C=>!C.completed);E.length>0&&(x+=`<div style="margin-top: 10px;">
            <p style="font-weight: bold; color: #555; font-size: 14px;">Actions:</p>
            <ul style="padding-left: 20px;">`,E.forEach(C=>{x+=`
              <li style="margin-bottom: 5px;">
                <div style="font-size: 14px;">
                  ${C.action}
                  ${C.byDate?`<span style="color: #888; font-size: 12px;"> (Due: ${C.byDate})</span>`:""}
                </div>
              </li>
            `}),x+="</ul></div>")}x+="</div>"}),x+=`
      <p style="font-size: 14px; color: #666; margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
        This email was sent from the Lift application.
      </p>
    `,x},S=async()=>{try{if(n(!0),d(null),!o||o.trim()==="")throw new Error("Manager email is not set. Please set a manager email first.");const x={from:"notifications@lift-app.com",to:[o],subject:`${r} would like to share statements with you`,html:w()};await ir(x),m(!0),setTimeout(()=>s(),2e3)}catch(x){console.error("Failed to send email:",x),d(typeof x=="object"&&x!==null&&"message"in x?x.message:"Failed to send email. Please try again later.")}finally{n(!1)}};return e.jsx(X,{open:!0,onOpenChange:s,children:e.jsx(Z,{headerTitle:`Sharing with ${a||"your manager"}`,children:e.jsxs("div",{className:"relative rounded-md overflow-hidden",style:{border:"8px solid transparent",borderImage:"repeating-linear-gradient(45deg, #ff69b4, #ff69b4 10px, #4169e1 10px, #4169e1 20px) 8",padding:"16px",margin:"-8px",background:"#f9f9f9"},children:[e.jsx("div",{className:"absolute top-4 right-4 w-16 h-20 border-2 border-gray-400 border-dashed rounded-sm opacity-20 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-12 h-12 border-2 border-gray-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"transform rotate-12 text-gray-500 text-[10px] font-mono",children:"MAIL"})})}),e.jsx(ee,{className:"mt-0 text-center",children:"Below are your public, unresolved statements"}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Email will be sent to: ",o||"No email set"]}),h&&e.jsx("p",{className:"text-green-600 text-sm font-medium mt-2 bg-green-50 py-1 px-2 rounded-full inline-block",children:"✓ Email sent successfully!"})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:c}),e.jsx("div",{className:"mt-4 space-y-5 max-h-[50vh] overflow-y-auto px-1",children:g.length>0?g.map(x=>e.jsxs("div",{className:"p-4 border bg-white shadow-sm rounded-sm relative",style:{backgroundImage:"linear-gradient(0deg, rgba(255, 105, 180, 0.05) 1px, transparent 1px)",backgroundSize:"100% 20px",borderColor:"#e5e5e5"},children:[e.jsxs("p",{className:"text-base font-semibold",children:[x.atoms.subject," ",I(x.atoms.verb)," ",x.atoms.object]}),x.actions&&x.actions.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-gray-500 font-semibold border-b border-gray-200 pb-1 mb-2",children:"Actions"}),x.actions.filter(l=>!l.completed).map(l=>e.jsxs("div",{className:"pl-3 border-l-2 border-pink-200 ml-2 py-1",children:[e.jsx("p",{className:"text-sm",children:l.action}),l.byDate&&l.byDate.trim()!==""&&e.jsxs("p",{className:"text-xs text-gray-500 italic",children:["Due by: ",l.byDate]})]},l.id))]}),e.jsx("div",{className:"absolute top-1 right-2 opacity-20",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M21 14H3M21 4H3M21 9H3M21 19H3",stroke:"#ff69b4",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},x.id)):e.jsx("div",{className:"text-gray-600 text-center p-8 bg-white border border-gray-200 rounded-sm",children:"No public unresolved statements available."})}),e.jsxs("div",{className:"mt-6 flex justify-center gap-4",children:[e.jsx(j,{variant:"default",onClick:S,disabled:i||g.length===0||!o,className:"shadow-sm",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx("span",{children:"Sending..."})]}):e.jsx("span",{children:"Send Email"})}),e.jsx(j,{variant:"outline",onClick:s,children:e.jsx("span",{children:"Close"})})]})]})})})},cr=()=>{const s=()=>({id:Date.now().toString(),input:"Alice supports the project",isPublic:!0,atoms:{subject:"Alice",verb:"supports",object:"the project"},category:"wellbeing",actions:[{id:"a"+Date.now().toString(),creationDate:new Date().toISOString(),byDate:"",action:"Review the project plan",completed:!1}]}),{setData:t}=q(),r=()=>{const a=s();t({type:"ADD_ENTRY",payload:a})};return e.jsx(j,{onClick:r,variant:"outline",className:"px-4 py-2",children:"Create Test Statement"})},dr=()=>{const{data:s}=q(),{username:t,managerName:r,managerEmail:a,entries:o}=s,[i,n]=R.useState(!1),[c,d]=R.useState(!1),h=a&&a.trim().length>0,m=o.filter(x=>x.isPublic).length,g=!h||m===0,w=()=>{n(!0)},S=()=>{d(!0)};return e.jsxs("main",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 py-12",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:r?`${t} would like to share with ${r}`:`${t}'s statements for sharing`}),e.jsx("div",{className:"container mx-auto px-4",children:e.jsx(or,{username:t})}),e.jsxs("div",{className:"fixed bottom-8 right-8 flex items-center space-x-4 z-30",children:[e.jsxs(F,{children:[e.jsx(H,{asChild:!0,children:e.jsx("span",{children:e.jsx(j,{onClick:S,variant:"outline",className:"rounded-full p-3 shadow-lg bg-white hover:bg-gray-100",disabled:g,children:e.jsx(ke,{className:"w-6 h-6 text-brand-pink"})})})}),e.jsx(M,{className:"bg-gray-800 text-white p-2 rounded",children:h?m===0?"Please create at least one public statement to share.":"Send email with your public statements.":"Please add your manager's email address first."})]}),e.jsxs(j,{onClick:w,variant:"pink",className:"rounded-full flex items-center px-3 py-2 sm:px-4 sm:py-3 shadow-lg",children:[e.jsx(tt,{className:"w-5 h-5 sm:w-6 sm:h-6"}),e.jsxs("span",{className:"ml-1 sm:ml-2 text-base sm:text-lg",children:[e.jsx("span",{className:"hidden sm:inline",children:"Custom statement"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})]}),e.jsx(cr,{})]}),i&&e.jsx(bs,{username:t,onComplete:()=>n(!1),onClose:()=>n(!1)}),c&&e.jsx(lr,{onClose:()=>d(!1)})]})},ur=()=>{const{data:s}=q();return u.useEffect(()=>{(async()=>{await as()})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ut,{}),s.username?e.jsx(dr,{}):e.jsx(Dt,{})]})},mr=()=>e.jsx(rt,{children:e.jsx(vt,{children:e.jsx(Nt,{children:e.jsxs(Ct,{children:[e.jsx(ur,{}),!1]})})})});at.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(mr,{})}));
